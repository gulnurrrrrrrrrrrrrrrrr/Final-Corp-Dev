<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <title>–°–∞–±–∞“õ ‚Äî QuadLingo</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>–°–∞–±–∞“õ</h1>
        <nav>
            <a href="index.html">‚Üê –ë–∞—Å—Ç—ã –±–µ—Ç</a>
            <a href="profile.html">–ü—Ä–æ—Ñ–∏–ª—å</a>
        </nav>
    </header>

    <div class="container">
        <div id="lesson" class="card"></div>

        <div id="test" class="card" style="display:none">
            <h2>–¢–µ—Å—Ç</h2>
            <div id="questions"></div>
            <button onclick="submitTest()">–¢–∞–ø—Å—ã—Ä—É</button>
            <div id="result"></div>
        </div>
    </div>

    <script>
        const API = 'http://localhost:8080';
        const token = localStorage.getItem('token');
        const lessonId = new URLSearchParams(window.location.search).get('id');

        async function loadLesson() {
            const res = await fetch(API + '/lessons/' + lessonId);
            const lesson = await res.json();
            document.getElementById('lesson').innerHTML = `
                <h2>${lesson.title}</h2>
                <p>${lesson.description || ''}</p>
                <div style="background:#f8f9fa; padding:25px; border-radius:10px; line-height:1.8">
                    ${lesson.content.replace(/\n/g, '<br>')}
                </div>
                <button onclick="startTest()">–¢–µ—Å—Ç—Ç—ñ –±–∞—Å—Ç–∞—É</button>
            `;
        }

        function startTest() {
            // –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –∏–∑ –ë–î)
            const questions = [
                {id: 1, text: "–°”ô–ª–µ–º–µ—Ç—Å—ñ–∑ –±–µ –¥–µ–≥–µ–Ω –Ω–µ?", options: ["–ü—Ä–∏–≤–µ—Ç", "–°”ô–ª–µ–º–µ—Ç—Å—ñ–∑ –±–µ", "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è"], correct: 1},
                {id: 2, text: "–†–∞—Ö–º–µ—Ç—Ç—ñ“£ –∂–∞—É–∞–±—ã –Ω–µ?", options: ["–ê—Ä–∑—ã–º–∞—Å", "–†–∞—Ö–º–µ—Ç", "“ö–æ—à –±–æ–ª"], correct: 0}
            ];

            let html = '';
            questions.forEach(q => {
                html += `<div class="question">
                    <p><strong>${q.text}</strong></p>`;
                q.options.forEach((opt, idx) => {
                    html += `<label class="option">
                        <input type="radio" name="q${q.id}" value="${idx}">
                        ${opt}
                    </label>`;
                });
                html += `</div>`;
            });
            document.getElementById('questions').innerHTML = html;
            document.getElementById('test').style.display = 'block';
        }

        function submitTest() {
            let score = 0;
            const questions = document.querySelectorAll('.question');
            questions.forEach(q => {
                const selected = q.querySelector('input[type="radio"]:checked');
                if (selected && parseInt(selected.value) === 1) score++; // –ø—Ä–∏–º–µ—Ä
            });

            const result = document.getElementById('result');
            result.innerHTML = `<p style="color:green">–î“±—Ä—ã—Å –∂–∞—É–∞–ø—Ç–∞—Ä: ${score}/2</p>
                                <p>–°—ñ–∑ +${score * 10} –±–∞–ª–ª –∞–ª–¥—ã“£—ã–∑! üèÜ</p>`;
        }

        loadLesson();
    </script>
</body>
</html> 